var lrc = `[00:00.440]HEAVEN - Ailee (에일리)
[00:01.020]词：휘성
[00:01.090]曲：이기/서용배
[00:01.160]니가 있는 곳에
[00:01.160]有你的地方
[00:03.800]나도 함께 할게
[00:03.800]我会与你同在
[00:11.880]니가 가는 곳에
[00:11.880]你要去的地方
[00:14.380]나도 함께 갈게
[00:14.380]我也会跟随
[00:23.800]널 위해서 매일 웃고
[00:23.800]为了你我每天笑着
[00:26.480]널 위해서 기도하고
[00:26.480]为了你而祈祷
[00:29.430]니 생각에 잠들고
[00:29.430]想着你入睡
[00:32.040]널 부르며 눈을 떠
[00:32.040]一睁开眼就呼唤着你
[00:34.460]내 옆에서 지켜주고
[00:34.460]在我身边守护着我
[00:37.090]내 옆에서 감싸주는
[00:37.090]在我身边保护着我
[00:40.330]넌 나의 천국인걸
[00:40.330]你就是我的天堂
[00:43.720]You're my only one way
[00:43.720]你是我的唯一
[00:46.490]오직 너를 원해
[00:46.490]我只想要你
[00:49.460]내가 니 곁에 있음에 감사해
[00:49.460]允许我待在你身边 十分感谢
[00:54.310]You're the only one babe
[00:54.310]你是唯一 宝贝
[00:57.070]힘든 세상 속에 사랑을 알게 해준
[00:57.070]在这个痛苦世界里 是你让我知道了何为爱
[01:04.260]너 하나로 나는 행복해
[01:04.260]有你在身边我很幸福
[01:06.650]Heaven Heaven Heaven Heaven Heaven
[01:06.650]天堂 天堂 天堂 天堂 天堂
[01:09.330]Heaven Heaven Heaven Heaven Heaven
[01:09.330]天堂 天堂 天堂 天堂 天堂
[01:12.540]우리 함께라면
[01:12.540]我们在一起的话
[01:14.490]We will never cry never never cry
[01:14.490]我们永远不会哭泣 不会 不会哭泣
[01:17.430]Heaven Heaven Heaven Heaven Heaven
[01:17.430]天堂 天堂 天堂 天堂 天堂
[01:20.090]Heaven Heaven Heaven Heaven Heaven
[01:20.090]天堂 天堂 天堂 天堂 天堂
[01:23.120]영원히 둘이서 never gonna be alone
[01:23.120]永远两个人 永远不会孤单
[01:30.370]니 품에서 숨을 쉬고
[01:30.370]在你怀中呼吸
[01:33.270]니 품에서 입 맞추고
[01:33.270]在你怀中拥吻
[01:36.090]니 목소릴 들으면
[01:36.090]听见你的声音
[01:38.700]꿈 꾸는 것 만 같아
[01:38.700]似做梦般
[01:41.090]니 눈에서 알 수 있어
[01:41.090]我懂你的眼神
[01:43.730]니 사랑을 알 수 있어
[01:43.730]懂你的爱
[01:46.990]넌 나의 천국인걸
[01:46.990]你就是我的天堂
[01:50.300]You're my only one way
[01:50.300]你是我的唯一
[01:53.000]오직 너를 원해
[01:53.000]我只想要你
[01:56.070]내가 니 곁에 있음에 감사해
[01:56.070]允许我待在你身边 十分感谢
[02:00.950]You're the only one babe
[02:00.950]你是唯一 宝贝
[02:03.640]힘든 세상 속에
[02:03.640]在这个痛苦世界里
[02:06.640]사랑을 알게 해준
[02:06.640]是你让我知道了何为爱
[02:10.870]너 하나로 나는 행복해
[02:10.870]有你在身边我很幸福
[02:13.340]Heaven 나만의 사람
[02:13.340]天堂 专属我的人
[02:15.670]그래 나를 지켜줄 사람
[02:15.670]没错那个守护着我的人
[02:18.370]어떤 슬픔도 어떤 아픔도
[02:18.370]管他什么悲伤与疼痛
[02:21.450]너와 함께 한다면
[02:21.450]只要与你在一起
[02:25.160]어느 누구도 난 부럽지 않아
[02:25.160]我谁也不羡慕
[02:29.180]떨리는 두 손을 잡아줘
[02:29.180]牵起我颤抖的双手
[02:32.380]내가 사는 이유 너니까
[02:32.380]因为我活着的理由就是你
[02:35.790]You're my only one way
[02:35.790]你是我的唯一
[02:38.410]오직 너를 원해
[02:38.410]我只想要你
[02:41.390]내가 니 곁에 있음에 감사해
[02:41.390]允许我待在你身边 十分感谢
[02:46.300]You're the only one babe
[02:46.300]你是唯一 宝贝
[02:49.050]힘든 세상 속에
[02:49.050]在这个痛苦世界里
[02:52.020]사랑을 알게 해준
[02:52.020]是你让我知道了何为爱
[02:56.220]너 하나로 나는 행복해
[02:56.220]有你在身边我很幸福
[02:58.610]Heaven Heaven Heaven Heaven Heaven
[02:58.610]天堂 天堂 天堂 天堂 天堂
[03:01.400]Heaven Heaven Heaven Heaven Heaven
[03:01.400]天堂 天堂 天堂 天堂 天堂
[03:04.540]우리 함께라면
[03:04.540]我们在一起的话
[03:06.490]We will never cry never never cry
[03:06.490]我们永远不会哭泣 不会 不会哭泣
[03:09.380]Heaven Heaven Heaven Heaven Heaven
[03:09.380]天堂 天堂 天堂 天堂 天堂
[03:12.060]Heaven Heaven Heaven Heaven Heaven
[03:12.060]天堂 天堂 天堂 天堂 天堂
[03:15.100]영원히 둘이서 never gonna be alone
[03:15.100]永远两个人 永远不会孤单
[03:22.390]Oh so alone
[03:22.390]哦 如此孤单
`

const parseTime = (arr) => { //将时间解析成秒s
    let times = arr.split(":");
    let seconds = parseFloat(times[0])*60+parseFloat(times[1]);
    return seconds;
}
const parseLrc = () => { //解析字符串
    let result = [];
    let lines = lrc.split("\n");
    for (let i = 0; i < lines.length; i++) {
       let line = lines[i];
       let arrs = line.split("]");
       let obj = {
           time: parseTime(arrs[0].substring(1)),
           text: arrs[1]
       }
       result.push(obj);
    }
    return result;
}
 
 
let domData = {
    ul: document.querySelector('.container ul'),
    audio: document.querySelector('audio'),
    container: document.querySelector('.container'),
} //dom数据
let musicObj = parseLrc(); // 音乐数据
console.log(musicObj);

 
const getAudioTime = () => {
    let result = domData.audio.currentTime;
    return result;
}
 
const addMusic = () => {
    let documentFragment = document.createDocumentFragment();
 
    for(let i = 0; i < musicObj.length; i++){
        let li = document.createElement('li');
        li.textContent = musicObj[i].text;
        documentFragment.appendChild(li);
    }
 
    domData.ul.appendChild(documentFragment);
}
 
// 根据时间来获取当前需要显示的条数
const getMusicIndex = () => {
    let time = getAudioTime();
    for(let i = 0;i < musicObj.length; i++) {
        let musicTime = musicObj[i].time;
        if(time < musicTime){
            return i-1;
        }
    }
    return musicObj.length - 1;
}
// 移动...
let currentIndex = 0;
const move = () => {
    currentIndex = getMusicIndex(); //当前高亮的歌词下标
    let containerHeight = domData.container.clientHeight; //Container高度
    let liHeight = domData.ul.children[0].clientHeight; // 每个li标签的高度
    let movePx = liHeight * currentIndex + liHeight/2 - containerHeight/2; //需要移动的
    let maxMove = domData.ul.clientHeight - containerHeight/2;
    console.log('00000000000');
    console.log(currentIndex);
    
    
    // 范围判断
    if(movePx < 0){
        movePx = 0;
    }
    if(movePx > maxMove){
        movePx = maxMove;
    }
    // 取消前面的高亮
    let activeLi = domData.ul.querySelector('.active');
    if(activeLi){
        activeLi.classList.remove("active");
    }
    // 实现高亮
    let currentLi = domData.ul.children[currentIndex];
    if(currentLi){
        currentLi.classList.add('active');
    }
    // 移动
    domData.ul.style.transform = `translateY(-${movePx}px)`;
}
domData.audio.addEventListener('timeupdate',move);
 
const init = () => {
    //获取页面歌词
//     插入歌词
    addMusic();
    console.log(musicObj)
//     根据时间来移动
}
init(); //入口函数